FILES: testdata/completion-ad.sh testdata/completion-aip.sh testdata/completion-auth.sh testdata/completion-cmp.sh testdata/completion-diff.sh testdata/completion-faux.sh testdata/completion-stress.sh testdata/ntc_sms_send.py testdata/send-sms.sh testdata/set-apisix.sh testdata/test-websocket.py testdata/websocket.py testdata/ws-cli.py
sh completion-faux.sh testdata/completion-ad.sh
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/bin/sh\n\nTYPE=\"Content-Type: application/json\"\nHOST=\"172.16.254.5\"\nPORT=\"32080\"\nDATA='{\n  \"model\": \"DeepSeek-Coder-V2-Lite-Base\",\n  \"prompt\": \"#!/usr/bin/env python\\n# coding: utf-8\\n# author：钱锴19648(感谢大佬分享)\\nimport time\\nimport base64\\nfrom Crypto.Cipher import AES\\nimport requests\\ndef trace(rsp):\\n    print\"\n}'\n\nif [ X\"$1\" != X\"\" ]; then\n  PORT=\"$1\"\nfi\n\nif [ X\"$2\" != X\"\" ]; then\n  DATA=`jq --arg newValue \"$(cat $2)\" '.prompt = $newValue' <<< '{\"model\": \"DeepSeek-Coder-V2-Lite-Base\",\"prompt\": \"\"}'`\nfi\n\necho ADDR: http://$HOST:$PORT/v1/completions\necho DATA: $DATA\n\ncurl -i http://$HOST:$PORT/v1/completions -H \"$TYPE\" -X POST -d \"$DATA\"\n\n# '{\n#   \"model\": \"DeepSeek-Coder-V2-Lite-Base\",\n#   \"prompt\": \"#!/usr/bin/env python\\n# coding: utf-8\\n# author：钱锴19648(感谢大佬分享)\\nimport time\\nimport base64\\nfrom Crypto.Cipher import AES\\nimport requests\\ndef trace(rsp):\\n    print\"\n# }'"
}
HTTP/1.1 100 Continue

HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9951
X-RateLimit-Reset: 41725
date: Wed, 16 Oct 2024 03:00:48 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-j1QwqVqJoOyulYat5KdmoJwF0ufxb\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/completion-aip.sh
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/bin/sh\n\nTYPE=\"Content-Type: application/json\"\nHOST=\"10.72.1.16\"\nPORT=\"32322\"\n\nif [ X\"$1\" != X\"\" ]; then\n  PORT=\"$1\"\nfi\n\necho ADDR: http://$HOST:$PORT/v1/completions\n\ncurl -i http://$HOST:$PORT/v1/completions -H \"$TYPE\" -X POST  -d '{\n  \"model\": \"DeepSeek-Coder-V2-Lite-Base\",\n  \"prompt\": \"#!/usr/bin/env python\\n# coding: utf-8\\n# author：钱锴19648(感谢大佬分享)\\nimport time\\nimport base64\\nfrom Crypto.Cipher import AES\\nimport requests\\ndef trace(rsp):\\n    print\"\n}'"
}
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9950
X-RateLimit-Reset: 41725
date: Wed, 16 Oct 2024 03:00:49 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-gA8nn0N2efCKfhPsAXCo9NBf7MaUp\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/completion-auth.sh
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/bin/sh\n\n# 获取访问令牌\nCLIENT_ID=\"vscode\"\nCLIENT_SECRET=\"jFWyVy9wUKKSkX55TDBt2SuQWl7fDM1l\"\nTOKEN_ENDPOINT=\"https://zgsm.sangfor.com/realms/gw/protocol/openid-connect/token\"\nAUTHORIZATION_ENDPOINT=\"https://zgsm.sangfor.com/realms/gw/protocol/openid-connect/auth\"\nINFERENCE_ENDPOINT=\"https://zgsm.sangfor.com/v2/completions\"\nREDIRECT_URI=\"https://zgsm.sangfor.com/callback\"\nSCOPE=\"openid profile email\"\nSTATE=\"012345678\"\nFILE=\"./access_token\"\n\nACCESS_TOKEN=\"\"\nif [ -f \"$FILE\" ]; then\n  # 读取文件内容到变量ACCESS_TOKEN中\n  ACCESS_TOKEN=$(cat \"$FILE\")\nelse\n  # 步骤1：获取授权码\n  echo \"请在浏览器中打开以下URL并授权：\"\n  AUTH_URL=\"${AUTHORIZATION_ENDPOINT}?response_type=code&client_id=${CLIENT_ID}&redirect_uri=${REDIRECT_URI}&scope=${SCOPE}&state=${STATE}\"\n  echo $AUTH_URL\n\n  # 提示用户输入授权码\n  read -p \"请输入从重定向URL中获取的授权码: \" AUTH_CODE\n\n  # 步骤2：使用授权码获取访问令牌\n  RESPONSE=$(curl -k -s -X POST $TOKEN_ENDPOINT \\\n    -H \"Content-Type: application/x-www-form-urlencoded\" \\\n    -d \"grant_type=authorization_code\" \\\n    -d \"client_id=$CLIENT_ID\" \\\n    -d \"client_secret=$CLIENT_SECRET\" \\\n    -d \"code=$AUTH_CODE\" \\\n    -d \"redirect_uri=$REDIRECT_URI\")\n\n  # 解析访问令牌\n  ACCESS_TOKEN=$(echo $RESPONSE | jq -r '.access_token')\n\n  # 检查是否成功获取访问令牌\n  if [ \"$ACCESS_TOKEN\" == \"null\" ]; then\n    echo \"获取访问令牌失败：$RESPONSE\"\n    exit 1\n  fi\n  echo $ACCESS_TOKEN > ./access_token\nfi\n\necho \"访问令牌: $ACCESS_TOKEN\"\n\n# 使用访问令牌访问受保护的资源\n# 使用令牌发送请求\nRSP=`curl -k -i -X POST -H \"Authorization: Bearer $ACCESS_TOKEN\" -H \"Content-Type: application/json\" $INFERENCE_ENDPOINT -d '{\n     \"model\": \"DeepSeek-Coder-V2-Lite-Base\",\n     \"prompt\": \"def hello\"\n   }'`\n\necho $RSP\necho $RSP | grep 'HTTP/1.1 401 Unauthorized' && echo Unauthorized, please remove ./access_token and retry it && exit 1\necho $RSP | grep 'HTTP/1.1 200' && echo Succeeded && exit 0"
}
HTTP/1.1 100 Continue

HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9949
X-RateLimit-Reset: 41724
date: Wed, 16 Oct 2024 03:00:49 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-wScOl7k0U6ivByAhJ9XJuIvkopEyS\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/completion-cmp.sh
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/bin/sh\n\nFILES=`ls *.*`\nPORTS=(32326 32329)\n\necho FILES: $FILES\necho PORTS: $PORTS\n\nfor file in $FILES; do\n  if [[ -f \"$file\" ]]; then\n    echo $file\n    for port in \"${PORTS[@]}\"; do\n      echo sh completion-ad.sh $port $file\n      time sh completion-ad.sh $port $file\n    done\n  fi\ndone"
}
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9948
X-RateLimit-Reset: 41723
date: Wed, 16 Oct 2024 03:00:51 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-r6kkFCMwHk232MYt5FCSt2zKhPMv8\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/completion-diff.sh
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/bin/sh\n\nFAUX_ADDR=\"http://10.200.101.5:30080/v2/completions\"\nAD_ADDR=\"http://172.16.254.5:32080/v1/completions\"\nAIP_ADDR=\"http://172.16.254.1:32322/v1/completions\"\nFILE=\"./access_token\"\n\nACCESS_TOKEN=\"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjY3OTkwNjQsImlhdCI6MTcyNjc5Nzg2NCwiYXV0aF90aW1lIjoxNzI2Nzk1MTU3LCJqdGkiOiI1ZTNmNThkNS0zYTg5LTQzYWEtYWQ2ZS00MWM2ZTI4ZGRlYmMiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjMwYTA3NGE3LTM4ZTktNGY0Ny1iZWMwLTRlYjBlYmY3MjE2YSIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiIxNzIwZmI2NS03ZmRlLTQ0OGQtYTRmNC03MDQwOTdlNzE3NmEiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiMTcyMGZiNjUtN2ZkZS00NDhkLWE0ZjQtNzA0MDk3ZTcxNzZhIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ6YmMiLCJnaXZlbl9uYW1lIjoiIiwiZmFtaWx5X25hbWUiOiIiLCJlbWFpbCI6InpiY0BzYW5nZm9yLmNvbS5jbiJ9.HgOpfYXNlACy_AYwLp1ztVjMoYtojLwnkpwTpvb1j2KWJpzmRYNCJhkbNmA4MTmPfuZkEJUFX0tMnDP0zmSKCvoYrssVLZiA49xIz7N2kU-zXnwb5vOBjkb_cN4zr2vVve1Wc2zBenNicJkdXBRAYYkyTQ4KkqamchhZ_aDoqGuDxzVMcojMT5sJnPka2XU8Gv-2vtfab2xpIOF9CWaAbd44wBrNeyOwNOa4k3vDcjMsTBPt7hB4kmJIl55XqCLU6S9K7kCDP05J3EpogYSjU4vEtsT5rFP-NUo5RI7eiLN8v4fgCGFWX9Nv4O9PxyRCqVoa2NdhPYk24GptfZtNZQ\"\nif [ -f \"$FILE\" ]; then\n  # 读取文件内容到变量ACCESS_TOKEN中\n  ACCESS_TOKEN=$(cat \"$FILE\")\nfi\n\nAUTH=\"Authorization: Bearer $ACCESS_TOKEN\"\nTYPE=\"Content-Type: application/json\"\n\nRANDS=`< /dev/urandom tr -dc 'A-Za-z' | head -c 10`\nPROMPT=\"#!/usr/bin/env python\\n# coding: utf-8\\n\\nimport time\\nimport base64\\nfrom Crypto.Cipher import AES\\nimport requests\\n$RANDS=rsp\\ndef trace(rsp):\\n  print\"\n\necho FAUXPILOT: $FAUX_ADDR\necho AD: $AD_ADDR\necho AUTH: $AUTH\necho PROMPT: \"$PROMPT\"\n\necho ------------------------------------------------------------------------------\ntime curl -i $FAUX_ADDR -H \"$AUTH\" -H \"$TYPE\" -X POST  -d '{\n  \"model\": \"DeepSeek-Coder-V2-Lite-Base\",\n  \"prompt\": \"'\"$PROMPT\"'\"\n}'\n\necho ------------------------------------------------------------------------------\ntime curl -i $AD_ADDR -H \"$TYPE\" -X POST  -d '{\n  \"model\": \"DeepSeek-Coder-V2-Lite-Base\",\n  \"prompt\": \"'\"$PROMPT\"'\"\n}'\n\n# time curl -i $AIP_ADDR -H \"$TYPE\" -X POST  -d '{\n#   \"model\": \"DeepSeek-Coder-V2-Lite-Base\",\n#   \"prompt\": \"'\"$PROMPT\"'\"\n# }'"
}
HTTP/1.1 100 Continue

HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9947
X-RateLimit-Reset: 41722
date: Wed, 16 Oct 2024 03:00:52 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-4WskxeZpfz8rL91styzOAEvT9ZZgb\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/completion-faux.sh
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/bin/sh\n\nFAUX_ADDR=\"http://zgsm.sangfor.com/v2/completions\"\nFILE=\"./access_token\"\n\nACCESS_TOKEN=\"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjY3OTkwNjQsImlhdCI6MTcyNjc5Nzg2NCwiYXV0aF90aW1lIjoxNzI2Nzk1MTU3LCJqdGkiOiI1ZTNmNThkNS0zYTg5LTQzYWEtYWQ2ZS00MWM2ZTI4ZGRlYmMiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjMwYTA3NGE3LTM4ZTktNGY0Ny1iZWMwLTRlYjBlYmY3MjE2YSIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiIxNzIwZmI2NS03ZmRlLTQ0OGQtYTRmNC03MDQwOTdlNzE3NmEiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiMTcyMGZiNjUtN2ZkZS00NDhkLWE0ZjQtNzA0MDk3ZTcxNzZhIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ6YmMiLCJnaXZlbl9uYW1lIjoiIiwiZmFtaWx5X25hbWUiOiIiLCJlbWFpbCI6InpiY0BzYW5nZm9yLmNvbS5jbiJ9.HgOpfYXNlACy_AYwLp1ztVjMoYtojLwnkpwTpvb1j2KWJpzmRYNCJhkbNmA4MTmPfuZkEJUFX0tMnDP0zmSKCvoYrssVLZiA49xIz7N2kU-zXnwb5vOBjkb_cN4zr2vVve1Wc2zBenNicJkdXBRAYYkyTQ4KkqamchhZ_aDoqGuDxzVMcojMT5sJnPka2XU8Gv-2vtfab2xpIOF9CWaAbd44wBrNeyOwNOa4k3vDcjMsTBPt7hB4kmJIl55XqCLU6S9K7kCDP05J3EpogYSjU4vEtsT5rFP-NUo5RI7eiLN8v4fgCGFWX9Nv4O9PxyRCqVoa2NdhPYk24GptfZtNZQ\"\nif [ -f \"$FILE\" ]; then\n  # 读取文件内容到变量ACCESS_TOKEN中\n  ACCESS_TOKEN=$(cat \"$FILE\")\nfi\n\nAUTH=\"Authorization: Bearer $ACCESS_TOKEN\"\nTYPE=\"Content-Type: application/json\"\nDATA='{\n  \"model\": \"DeepSeek-Coder-V2-Lite-Base\",\n  \"prompt\": \"def \"\n}'\n\nif [ X\"$1\" != X\"\" ]; then\n  DATA=`jq --arg newValue \"$(cat $1)\" '.prompt = $newValue' <<< '{\"model\": \"DeepSeek-Coder-V2-Lite-Base\",\"prompt\": \"\"}'`\nfi\n\necho FAUXPILOT: $FAUX_ADDR\necho AUTH: $AUTH\necho DATA: \"$DATA\"\n\ncurl -k -i $FAUX_ADDR -H \"$AUTH\" -H \"$TYPE\" -X POST  -d \"$DATA\""
}
HTTP/1.1 100 Continue

HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9946
X-RateLimit-Reset: 41721
date: Wed, 16 Oct 2024 03:00:53 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-VQDF95baNj6FPSM7LUqKZbgeGAHBb\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/completion-stress.sh
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/bin/sh\n\nAUTH=\"Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjY4MTQzNTksImlhdCI6MTcyNjgxMzE1OSwiYXV0aF90aW1lIjoxNzI2ODEzMTUzLCJqdGkiOiJhZGVmZGYxOS0xZjJkLTRiOTgtODI4MS1hOTU3ZjkzNGFjMGEiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjMwYTA3NGE3LTM4ZTktNGY0Ny1iZWMwLTRlYjBlYmY3MjE2YSIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJkYzBjZWNkMi0zZDI1LTQ1NzYtYTYwNC0zNDZjZTg1OTAwMzEiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiZGMwY2VjZDItM2QyNS00NTc2LWE2MDQtMzQ2Y2U4NTkwMDMxIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ6YmMiLCJnaXZlbl9uYW1lIjoiIiwiZmFtaWx5X25hbWUiOiIiLCJlbWFpbCI6InpiY0BzYW5nZm9yLmNvbS5jbiJ9.WjSda_CNkoeMG8EoLtM1RCbc4uyO13ez_Yvy3XngQeuUJTAvgEohM2Dgh1n5PVOiZCp37J7HWDOjYY131i1PcB3_MkBDjQl1j2bCwpuSx70S8-uPt3vhhrFRf6aCNCfV__GjXblBOfjsOO1OJrEQVDRCZFhNso3XUYx5HUerf-Ye2RRP17NlgeIVJ04tIBn_VHHQkKjWOiGAQ71oHsXpslpulTbs8l-ZeoNni99RgFO_maV9LHXy7JVmj3ksg1X9N53Kw3JnWE-do3UCPoaEP9awnYh3QLkkVPUzBy9QPh-FiKaHGJxwJkCpQ-AuqzAopfEqRreBb3OFYjKrcxHhLw\"\nTYPE=\"Content-Type: application/json\"\n\nFAUX_ADDR=\"http://10.200.101.5:30080/v1/completions\"\n\nfor i in {1..10}\ndo\n  curl -i $FAUX_ADDR -H \"$AUTH\" -H \"$TYPE\" -X POST  -d '{\n    \"model\": \"DeepSeek-Coder-V2-Lite-Base\",\n    \"prompt\": \"#!/bin/sh\\n\\nAUTH=\\\"Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjY3OTkwNjQsImlhdCI6MTcyNjc5Nzg2NCwiYXV0aF90aW1lIjoxNzI2Nzk1MTU3LCJqdGkiOiI1ZTNmNThkNS0zYTg5LTQzYWEtYWQ2ZS00MWM2ZTI4ZGRlYmMiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjMwYTA3NGE3LTM4ZTktNGY0Ny1iZWMwLTRlYjBlYmY3MjE2YSIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiIxNzIwZmI2NS03ZmRlLTQ0OGQtYTRmNC03MDQwOTdlNzE3NmEiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiMTcyMGZiNjUtN2ZkZS00NDhkLWE0ZjQtNzA0MDk3ZTcxNzZhIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ6YmMiLCJnaXZlbl9uYW1lIjoiIiwiZmFtaWx5X25hbWUiOiIiLCJlbWFpbCI6InpiY0BzYW5nZm9yLmNvbS5jbiJ9.HgOpfYXNlACy_AYwLp1ztVjMoYtojLwnkpwTpvb1j2KWJpzmRYNCJhkbNmA4MTmPfuZkEJUFX0tMnDP0zmSKCvoYrssVLZiA49xIz7N2kU-zXnwb5vOBjkb_cN4zr2vVve1Wc2zBenNicJkdXBRAYYkyTQ4KkqamchhZ_aDoqGuDxzVMcojMT5sJnPka2XU8Gv-2vtfab2xpIOF9CWaAbd44wBrNeyOwNOa4k3vDcjMsTBPt7hB4kmJIl55XqCLU6S9K7kCDP05J3EpogYSjU4vEtsT5rFP-NUo5RI7eiLN8v4fgCGFWX9Nv4O9PxyRCqVoa2NdhPYk24GptfZtNZQ\\\"\\nTYPE=\\\"Content-Type: application/json\\\"\\n\\nFAUX_ADDR=\\\"http://10.200.101.5:30080/v1/completions\\\"\\nAD_ADDR=\\\"http://172.16.254.5:32322/v1/completions\\\"\\nAIP_ADDR=\\\"http://172.16.254.1:32322/v1/completions\\\"\\n\\ntime curl -i $FAUX_ADDR -H \\\"$AUTH\\\" -H \\\"$TYPE\\\" -X POST  \"\n  }' &\ndone\n\nwait"
}
HTTP/1.1 100 Continue

HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9945
X-RateLimit-Reset: 41720
date: Wed, 16 Oct 2024 03:00:54 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-uqVh4dle7sg3wUuuENNWYTKcJlALG\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/ntc_sms_send.py
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/usr/bin/env python\r\n# coding: utf-8\r\n# author：钱锴19648(感谢大佬分享)\r\nimport time\r\nimport base64\r\nfrom Crypto.Cipher import AES\r\nimport requests\r\n\r\ndef trace(rsp):\r\n    print(\"Request URL:\", rsp.request.url)\r\n    print(\"Request Method:\", rsp.request.method)\r\n    print(\"Request Headers:\", rsp.request.headers)\r\n    print(\"Request Body:\", rsp.request.body)\r\n\r\n    # 输出响应的详细信息\r\n    print(\"Response Status Code:\", rsp.status_code)\r\n    print(\"Response Headers:\", rsp.headers)\r\n    print(\"Response Content:\", rsp.text)\r\n    \r\ndef get_token():\r\n    BS = 16\r\n    pad = lambda s: s + (BS - len(s) % BS) * chr(BS - len(s) % BS)\r\n    # 应用加密Key\r\n    my_secret = \"a80982a50d0b4f7a98db6b91fdaf34ae\"\r\n    # 偏移量\r\n    iv = \"TRYTOCN314402233\"\r\n\r\n    # 计算当前时间戳，精确到毫秒\r\n    t = time.time()\r\n    timestamp = str(int(round(t * 1000)))\r\n\r\n    # 需要加密的字符串\r\n    text = pad('{\"clientId\": \"1724993521440\",\"timesstamp\": %s}' % timestamp).encode()\r\n\r\n    cipher = AES.new(my_secret.encode(), AES.MODE_CBC, iv.encode())  # 加密函数  密钥 模式 偏移量\r\n    login_code = base64.urlsafe_b64encode(cipher.encrypt(text)).decode('utf-8')  # 先加密再重新编码\r\n    # url = f\"http://it-gw.sangfor.com/api/api-auth/oauth/get/jwttoken?loginCode={login_code}&clientId=1724993521440\"\r\n    url = \"http://it-gw.sangfor.com/api/api-auth/oauth/get/jwttoken?loginCode={}&clientId=1724993521440\".format(login_code)\r\n    payload = {}\r\n    headers = {}\r\n\r\n    response = requests.request(\"POST\", url, headers=headers, data=payload)\r\n    trace(response)\r\n    return response.json()[\"rows\"][\"access_token\"]\r\n\r\n\r\ndef send_sms(user_list, title, msg):\r\n    url = \"http://it-gw.sangfor.com/ntc/sms/sendSms\"\r\n    token = get_token()\r\n    headers = {\r\n        \"authorization\": token,\r\n        \"Content-Type\": \"application/json\"\r\n    }\r\n\r\n    # 把user_list转换成字符串\r\n    sendTo = \"\"\r\n    for user in user_list:\r\n        if sendTo != \"\":\r\n            sendTo += \",\"\r\n        sendTo += user\r\n    content = title + \"\\n\" + msg\r\n    data = {\r\n        \"systemCode\": \"shenma\",\r\n        \"phone\": sendTo,\r\n        \"systemCodePrefix\": \"0\",\r\n        \"content\": content\r\n    }\r\n\r\n    response = requests.post(url, headers=headers, json=data, timeout=5)\r\n    trace(response)\r\n    return response.json()\r\n\r\n# # author：廖磊57452(感谢大佬分享)\r\n# def intranet_mail_send_msg(recipient_list, subject, msg):\r\n#     token = get_token()\r\n#     url = \"http://it-gw-sit.sangfor.com/ntc/mail/lanSendMail\"\r\n#     headers = {\r\n#         \"authorization\": token,\r\n#         \"Content-Type\": \"application/json\"\r\n#     }\r\n\r\n#     # 把user_list转换成字符串\r\n#     recipient = \"\"\r\n#     for element in recipient_list:\r\n#         recipient += element\r\n#         recipient += \",\"\r\n\r\n#     data = {\r\n#         \"systemCode\": \"achktest\",\r\n#         \"recipient\": recipient,\r\n#         \"subject\": subject,\r\n#         \"content\": msg,\r\n#         \"fromName\": \"自动化测试\",\r\n#     }\r\n#     response = requests.post(url, headers=headers, json=data)\r\n#     print(response.json())\r\n\r\n\r\nif __name__ == '__main__':\r\n    # intranet_mail_send_msg(recipient_list=[\"57452@sangfor.com\"], subject=\"新春快乐\", msg=\"新年快乐恭喜发财\")\r\n    print(send_sms(user_list=[\"13824366192\"], title=\"323901\", msg=\"此认证码由诸葛神码发送，请勿泄露\"))\r\n\r\nif "
}
HTTP/1.1 100 Continue

HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9944
X-RateLimit-Reset: 41719
date: Wed, 16 Oct 2024 03:00:51 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-I4Bb8yuuBkR9gDEm5IbAntrkKHTWq\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/send-sms.sh
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/bin/sh\n\ncurl -i http://it-gw.sangfor.com/ntc/sms/sendSms -X POST -d '{\n  \"systemCode\": \"shenma\",\n  \"phone\": \"13824366192\",\n  \"systemCodePrefix\": \"0\",\n  \"content\": \"恭喜发财\"\n}'\n\ncurl "
}
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9943
X-RateLimit-Reset: 41718
date: Wed, 16 Oct 2024 03:00:56 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-UrUT3OKsKjAJuDSuJdatqhYyJCszj\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/set-apisix.sh
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/bin/sh\n\nAUTH=\"X-API-KEY: edd1c9f034335f136f87ad84b625c8f1\" \nTYPE=\"Content-Type: application/json\"\nAPISIX_ADDR=\"10.200.101.5:30180\"\nKEYCLOAK_ADDR=\"10.200.101.5:30880\"\nSHENMA_ADDR=\"10.200.101.5:30080\"\nSHENMA_IP=\"10.200.101.5\"\n\ncurl -i http://$APISIX_ADDR/apisix/admin/upstreams -H \"$AUTH\" -H \"$TYPE\" -X PUT  -d '{\n    \"id\": \"web1\",\n    \"nodes\": {\n        \"web1.shenma.svc.cluster.local:9081\": 1\n    },\n    \"type\": \"roundrobin\"\n}'\n\ncurl -i http://$APISIX_ADDR/apisix/admin/upstreams -H \"$AUTH\" -H \"$TYPE\" -X PUT -d '{\n    \"id\": \"web2\",\n    \"nodes\": {\n        \"web2.shenma.svc.cluster.local:9082\": 1\n    },\n    \"type\": \"roundrobin\"\n}'\n\ncurl -i http://$APISIX_ADDR/apisix/admin/upstreams -H \"$AUTH\" -H \"$TYPE\" -X PUT -d '{\n    \"id\": \"shenma\",\n    \"nodes\": {\n        \"web2.shenma.svc.cluster.local:9082\": 1\n    },\n    \"type\": \"roundrobin\"\n}'\n\ncurl -i http://$APISIX_ADDR/apisix/admin/routes -H \"$AUTH\" -H \"$TYPE\" -X PUT -d '{\n    \"id\": \"web1\",\n    \"uri\": \"/web1/*\",\n    \"upstream_id\": \"web1\",\n    \"plugins\": {\n        \"openid-connect\": {\n            \"client_id\": \"apisix\",\n            \"client_secret\": \"g5cxUb10HB1D0V1ErgVwssKsqg6rWLPj\",\n            \"discovery\": \"http://'\"$KEYCLOAK_ADDR\"'/realms/gw/.well-known/openid-configuration\",\n            \"introspection_endpoint_auth_method\": \"client_secret_basic\",\n            \"bearer_only\": false,\n            \"realm\": \"gw\"\n        }\n    }\n}'\n\ncurl -i http://$APISIX_ADDR/apisix/admin/routes -H \"$AUTH\" -H \"$TYPE\" -X PUT -d '{\n    \"id\": \"web2\",\n    \"uri\": \"/web2/*\",\n    \"upstream_id\": \"web2\",\n    \"plugins\": {\n        \"openid-connect\": {\n            \"client_id\": \"apisix\",\n            \"client_secret\": \"g5cxUb10HB1D0V1ErgVwssKsqg6rWLPj\",\n            \"discovery\": \"http://'\"$KEYCLOAK_ADDR\"'/realms/gw/.well-known/openid-configuration\",\n            \"introspection_endpoint_auth_method\": \"client_secret_basic\",\n            \"bearer_only\": false,\n            \"realm\": \"gw\"\n        }\n    }\n}'\n\ncurl -i  http://$APISIX_ADDR/apisix/admin/routes -H \"$AUTH\" -H \"$TYPE\" -X PUT -d '{\n    \"uri\": \"/project-manage/*\",\n    \"id\": \"pm1\",\n    \"plugins\": {\n      \"openid-connect\": {\n        \"client_id\": \"apisix\",\n        \"client_secret\": \"g5cxUb10HB1D0V1ErgVwssKsqg6rWLPj\",\n        \"discovery\": \"http://'\"$KEYCLOAK_ADDR\"'/realms/gw/.well-known/openid-configuration\",\n        \"introspection_endpoint_auth_method\": \"client_secret_basic\",\n        \"realm\": \"gw\",\n        \"bearer_only\": false,\n        \"redirect_uri\": \"http://'\"$SHENMA_ADDR\"'/project-manage\",\n        \"logout_path\": \"/logout\",\n        \"redirect_login\": true\n      },\n      \"proxy-rewrite\": {\n        \"regex_uri\": [\"^/project-manage/(.*)\", \"/$1\"]\n      }\n    },\n    \"upstream\": {\n      \"type\": \"roundrobin\",\n      \"nodes\": {\n        \"10.200.101.5:31000\": 1\n      }\n    }\n  }'\n\ncurl -i http://$APISIX_ADDR/apisix/admin/routes -H \"$AUTH\" -H \"$TYPE\" -X PUT -d '{\n    \"uri\": \"/completions/*\",\n    \"id\": \"shenma\",\n    \"upstream_id\": \"shenma\",\n    \"plugins\": {\n      \"limit-req\": {\n        \"rate\": 1,\n        \"burst\": 0,\n        \"rejected_code\": 503,\n        \"key\": \"remote_addr\"\n      },\n      \"openid-connect\": {\n        \"client_id\": \"apisix\",\n        \"client_secret\": \"g5cxUb10HB1D0V1ErgVwssKsqg6rWLPj\",\n        \"discovery\": \"http://'\"$KEYCLOAK_ADDR\"'/realms/gw/.well-known/openid-configuration\",\n        \"introspection_endpoint_auth_method\": \"client_secret_basic\",\n        \"bearer_only\": false,\n        \"realm\": \"gw\",\n        \"redirect_uri\": \"http://'\"$SHENMA_ADDR\"'/completions/callback\",\n        \"logout_path\": \"/completions/logout\",\n        \"redirect_login\": true\n      }\n    }\n  }'"
}
HTTP/1.1 100 Continue

HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9942
X-RateLimit-Reset: 41717
date: Wed, 16 Oct 2024 03:00:57 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-zB7OlusKcXTBGfUNImELbuBRBnVHe\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/test-websocket.py
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/usr/bin/env python\n# -*- coding: utf-8 -*-\nimport socketio\nfrom aiohttp import web\n\n# 创建一个 Socket.IO 服务器\nsio = socketio.AsyncServer(cors_allowed_origins='*')\n\n# 创建一个 aiohttp 应用\napp = web.Application()\nsio.attach(app)\n\n# 处理连接事件\n@sio.event\nasync def connect(sid, environ):\n    print(f'Client connected: {sid}')\n\n# 处理断开连接事件\n@sio.event\nasync def disconnect(sid):\n    print(f'Client disconnected: {sid}')\n\n# 处理自定义事件\n@sio.event\nasync def message(sid, data):\n    print(f'Message from {sid}: {data}')\n    await sio.send(sid, f'Server received: {data}')\n\n# 启动服务器\nif __name__ == '__main__':\n    web.run_app(app, host='127.0.0.1', port=6000)"
}
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9941
X-RateLimit-Reset: 41716
date: Wed, 16 Oct 2024 03:00:58 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-dkL2aHLSsu6543KPDXToKO6DFeUkh\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/websocket.py
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/usr/bin/env python\r\n# -*- coding: utf-8 -*-\r\nimport socketio\r\nfrom aiohttp import web\r\n\r\n# 创建一个 Socket.IO 服务器\r\nsio = socketio.AsyncServer(cors_allowed_origins='*')\r\n\r\n# 创建一个 aiohttp 应用\r\napp = web.Application()\r\nsio.attach(app)\r\n\r\n# 处理连接事件\r\n@sio.event\r\nasync def connect(sid, environ):\r\n    print(f'Client connected: {sid}')\r\n\r\n# 处理断开连接事件\r\n@sio.event\r\nasync def disconnect(sid):\r\n    print(f'Client disconnected: {sid}')\r\n\r\n# 处理自定义事件\r\n@sio.event\r\nasync def message(sid, data):\r\n    print(f'Message from {sid}: {data}')\r\n    await sio.send(sid, f'Server received: {data}')\r\n\r\n# 启动服务器\r\nif __name__ == '__main__':\r\n    web.run_app(app, host='0.0.0.0', port=8765)\r\n    "
}
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9940
X-RateLimit-Reset: 41715
date: Wed, 16 Oct 2024 03:00:59 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-ZB34Zt60TqW3S3ybfCvBfd67hZBoT\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"sh completion-faux.sh testdata/ws-cli.py
FAUXPILOT: http://zgsm.sangfor.com/v2/completions
AUTH: Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCVS1HUWZvdjk5WnBXckhYbjRGMlZ3U1hXMzBqbTNaY3JFRFVEM1BiaGhBIn0.eyJleHAiOjE3MjkwNDg4NTQsImlhdCI6MTcyOTA0NzY1NCwiYXV0aF90aW1lIjoxNzI5MDQwMTI5LCJqdGkiOiI3MWUzMzg1Yi1kMzlkLTQ0ZTItOTAyOC03ZjJiYTkwOTVlMGQiLCJpc3MiOiJodHRwczovL3pnc20uc2FuZ2Zvci5jb20vcmVhbG1zL2d3IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImNjNDE1ZDY5LWQxMDktNGMzMy04Mjk0LWMzMTBlODk3Zjc0MCIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzY29kZSIsInNlc3Npb25fc3RhdGUiOiJiYjRiZDk3OS1mZWRkLTQ2M2UtODI3ZC1lNDZkZmE4Y2UwMmMiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHBzOi8vemdzbS5zYW5nZm9yLmNvbSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZ3ciXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwaG9uZSBlbWFpbCBwcm9maWxlIiwic2lkIjoiYmI0YmQ5NzktZmVkZC00NjNlLTgyN2QtZTQ2ZGZhOGNlMDJjIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwaG9uZV9udW1iZXJfdmVyaWZpZWQiOnRydWUsInBob25lX251bWJlciI6Iis4NjEzODI0MzY2MTkyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiKzg2MTM4MjQzNjYxOTIifQ.kNI2k-sGISSEjo0-D-XnGBmkpLsfHh6qno5QbKGwtVpGsM_CpO7VP6c5oiW3VvcFZkb-xBxlWNjyh0JH5maqw3HataQMRXLN9Tfux6fJ2nZCXPCcDYy1ZJie58X3l2cvDTTitc4YA9ZiHg1Hr98JGX6K2MeIL-BbLT7lRKkhKXY2VP3YVw3MR6VX3KsY0dugDV6FYEd24NMy1l4LEtfH2KHgn4UW2nE3tlLZ2_pkwL80kBgmlGhPC8z_Oc-4aqD1EKQukkKe8UEMiZxvsO4WEsEdXZrSp8wIBWLoay7uaGQ18kfKV8yvCDuGKLLBu9tno7nUkPFXM6cMyw9IpUlNtQ
DATA: {
  "model": "DeepSeek-Coder-V2-Lite-Base",
  "prompt": "#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nimport socketio\nsio = socketio.Client()\n\nsio.connect('http://10.200.101.5:30765')\n\n@sio.event\ndef connect():\n    print('连接建立成功')\n\n@sio.event\ndef message(data):\n    print('收到消息：', data)\n\n@sio.event\ndef disconnect():\n    print('连接断开')\n\nsio.wait()"
}
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 114
Connection: keep-alive
X-RateLimit-Limit: 10000
X-RateLimit-Remaining: 9939
X-RateLimit-Reset: 41714
date: Wed, 16 Oct 2024 03:01:00 GMT
Server: APISIX/3.9.1

"{\"id\": \"cmpl-ePlUQNhA3kNccHSyefT6N6dVoHugy\", \"choices\": [], \"server_extra_kwargs\": {\"is_cache\": true}}"